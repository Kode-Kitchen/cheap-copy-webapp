<!DOCTYPE html>
<html lang="zh-CN" style="overflow: hidden;">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-COMPATIBLE" content="IE=EDGE">
    <meta name="description" content="一个练手的项目，使用vue">
    <meta name="keywords" name="郭晨光,vue">

    <!-- 禁止用户缩放 -->
    <meta name="viewport" content="width=device-width,
            initial-scale=1.0,minimum-scale=1.0,
            maximum-scale=1.0,user-scalable=no">

    <!-- 设置360浏览器使用极速模式 -->
    <meta name="renderer" content="webkit">

    <meta name="App-Config" content="fullscreen=yes,useHistoryState=yes,transition=yes">

    <!-- 禁止百度转码 -->
    <meta http-equiv="Cache-Control" content="no-siteapp"/>

    <link rel="icon" type="image/png" href="{{assets}}i/favicon.png">

    <!-- 下面的配置copy 妹子ui 的 http://amazeui.org/css/-->
    <!-- Add to homescreen for Chrome on Android -->
    <meta name="mobile-web-app-capable" content="yes">
    <link rel="icon" sizes="192x192" href="{{assets}}i/app-icon72x72@2x.png">

    <!-- Add to homescreen for Safari on iOS -->
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta content="yes" name="apple-touch-fullscreen">
    <meta name="apple-mobile-web-app-status-bar-style" content="white-translucent">
    <meta name="apple-mobile-web-app-title" content="友帮宝"/>
    <link rel="apple-touch-icon-precomposed" href="assets/i/app-icon72x72@2x.png">

    <!-- Tile icon for Win8 (144x144 + tile color) -->
    <meta name="msapplication-TileImage" content="assets/i/app-icon72x72@2x.png">
    <meta name="msapplication-TileColor" content="#0e90d2">

    <title>友帮宝</title>

    <link rel="stylesheet" href="./libs/ratchet/dist/css/ratchet.css">
    <link rel="stylesheet" href="./libs/font-awesome/css/font-awesome.min.css">
    <link rel="stylesheet" href="./stylesheets/style.css">
</head>

<body>

    <header class="bar bar-nav main-bg-color">
        <button id="nav-map" class="btn btn-link btn-nav pull-left main-font-color">
            全国
            <span class="icon icon-angle-down main-font-color"></span>
        </button>
        <button id="nav-filter" class="btn btn-link btn-nav pull-right main-font-color">
            筛选
            <span class="icon icon-filter main-font-color"></span>
        </button>
        <span id="search-icon" class="icon icon-search"></span>
        <h1 class="title main-font-color"><input id="main-search" placeholder="请输入查询的关键字" type="text"></h1>
    </header>

    <div class="content" id="wrapper" style="position:absolute; top:44px; bottom:50px; padding-top:0; overflow:hidden;">
        <div id="scroller">
            <div id="pullDown">
                <span>下拉刷新…</span>
            </div>
            <div class="slider" id="mySlider">
                <div class="slide-group">
                    <div class="slide">
                        <img src="./images/slide-1.jpg">
                    <span class="slide-text">
                        <span class="icon icon-left-nav"></span>
                        Slide me
                    </span>
                    </div>
                    <div class="slide">
                        <img src="./images/slide-2.jpg">
                    </div>
                    <div class="slide">
                        <img src="./images/slide-3.jpg">
                    </div>
                </div>
            </div>
            <ul class="table-view" id="list">
                <li class="table-view-cell media">
                    <a class="navigate-right">
                        <img class="media-object pull-left" src="http://placehold.it/42x42">
                        <div class="media-body">
                            Item 1
                            <p>Lorem ipsum dolor sit amet, consectetur adipisicing elit, sed do eiusmod tempor incididunt ut labore et dolore. Lorem ipsum dolor sit amet.</p>
                        </div>
                    </a>
                </li>
                <li class="table-view-cell media">
                    <a class="navigate-right">
                        <img class="media-object pull-left" src="http://placehold.it/42x42">
                        <div class="media-body">
                            Item 1
                            <p>Lorem ipsum dolor sit amet, consectetur adipisicing elit, sed do eiusmod tempor incididunt ut labore et dolore. Lorem ipsum dolor sit amet.</p>
                        </div>
                    </a>
                </li>
                <li class="table-view-cell media">
                    <a class="navigate-right">
                        <img class="media-object pull-left" src="http://placehold.it/42x42">
                        <div class="media-body">
                            Item 1
                            <p>Lorem ipsum dolor sit amet, consectetur adipisicing elit, sed do eiusmod tempor incididunt ut labore et dolore. Lorem ipsum dolor sit amet.</p>
                        </div>
                    </a>
                </li>
                <li class="table-view-cell media">
                    <a class="navigate-right">
                        <img class="media-object pull-left" src="http://placehold.it/42x42">
                        <div class="media-body">
                            Item 1
                            <p>Lorem ipsum dolor sit amet, consectetur adipisicing elit, sed do eiusmod tempor incididunt ut labore et dolore. Lorem ipsum dolor sit amet.</p>
                        </div>
                    </a>
                </li>
                <li class="table-view-cell media">
                    <a class="navigate-right">
                        <img class="media-object pull-left" src="http://placehold.it/42x42">
                        <div class="media-body">
                            Item 1
                            <p>Lorem ipsum dolor sit amet, consectetur adipisicing elit, sed do eiusmod tempor incididunt ut labore et dolore. Lorem ipsum dolor sit amet.</p>
                        </div>
                    </a>
                </li>
                <li class="table-view-cell media">
                    <a class="navigate-right">
                        <img class="media-object pull-left" src="http://placehold.it/42x42">
                        <div class="media-body">
                            Item 1
                            <p>Lorem ipsum dolor sit amet, consectetur adipisicing elit, sed do eiusmod tempor incididunt ut labore et dolore. Lorem ipsum dolor sit amet.</p>
                        </div>
                    </a>
                </li>
                <li class="table-view-cell media">
                    <a class="navigate-right">
                        <img class="media-object pull-left" src="http://placehold.it/42x42">
                        <div class="media-body">
                            Item 1
                            <p>Lorem ipsum dolor sit amet, consectetur adipisicing elit, sed do eiusmod tempor incididunt ut labore et dolore. Lorem ipsum dolor sit amet.</p>
                        </div>
                    </a>
                </li>
            </ul>
            <div id="pullUp">
                <span>上拉加载更多…</span>
            </div>
        </div>

    </div>

    <nav class="bar bar-tab">
        <a class="tab-item active" href="#">
            <span class="icon icon-home"></span>
            <span class="tab-label">创业圈</span>
        </a>
        <a class="tab-item" href="#">
            <span class="icon icon-map-marker"></span>
            <span class="tab-label">发现</span>
        </a>
        <a class="tab-item" href="#">
            <span class="icon icon-edit"></span>
            <span class="tab-label">发布</span>
        </a>
        <a class="tab-item" href="#">
            <span class="icon icon-comment-alt"></span>
            <span class="tab-label">消息</span>
        </a>
        <a class="tab-item" href="#">
            <span class="icon icon-gear"></span>
            <span class="tab-label">设置</span>
        </a>
    </nav>

    <!-- 第三方库文件 -->
    <script src="./libs/vue/dist/vue.js"></script>
    <script src="./libs/ratchet/dist/js/ratchet.js"></script>
    <script src="./libs/iscroll/build/iscroll-probe.js"></script>
    <script src="./libs/layer/build/mobile/layer.js"></script>
    <script>

        // 阻止整个页面的触摸触摸默认动作，避免页面整体上下滚动。
        window.addEventListener('touchmove', function(e){
            e.preventDefault();
        }, true);

        // 主函数
        window.onload = loaded;

        function loaded() {
            //alert(document.body.clientHeight);
            //document.querySelector('#wrapper').style.height = document.body.clientHeight-44-50+'px';
            var myScroll = new IScroll('#wrapper', {
                probeType: 3,
                //momentum: false,//关闭惯性滑动
                mouseWheel: true,//鼠标滑轮开启
                scrollbars: true,//滚动条可见
                fadeScrollbars: true,//滚动条渐隐
                interactiveScrollbars: true,//滚动条可拖动
                shrinkScrollbars: 'scale', // 当滚动边界之外的滚动条是由少量的收缩
                useTransform: true,//CSS转化
                useTransition: true,//CSS过渡
                bounce: true,//反弹
                freeScroll: false,//只能在一个方向上滑动
                startX: 0,
                startY: 0
            });

            var
                pullDown = document.querySelector('#pullDown'),
                pullUp = document.querySelector('#pullUp'),
                pullDownFlag = 0,
                pullUpFlag = 0;


            myScroll.on('scroll',positionJudge);
            myScroll.on("scrollEnd",action);

            function positionJudge(){
                if(this.y>80){    //判断下拉
                    pullDown.innerHTML = "放开刷新页面";
                    pullDownFlag = 1;
                }else if(this.y<(this.maxScrollY-40)){   //判断上拉
                    pullUp.innerHTML = "放开刷新页面";
                    pullUpFlag = 1;
                }

                if( this.y <20 && pullDownFlag==1 ){
                    pullDown.style.position = 'static';
                }

            }

            function action(){
                if(pullDownFlag==1){
                    pullDownAction();
                    pullDown.innerHTML = "正在刷新...";
                    pullDownFlag = 0;
                }else if(pullUpFlag==1){
                    pullUpAction();
                    pullUp.innerHTML = "上拉刷新...";
                    pullUpFlag = 0;
                }
            }

            function pullDownAction(){
//                var index = layer.open({type: 2});
                setTimeout(function(){
                    var ul = document.querySelector('ul.table-view');
                    var li = document.createElement('li');

                    li.setAttribute("class","table-view-cell media");
                    li.innerHTML='<a class="navigate-right">'+
                            '<img class="media-object pull-left" src="http://placehold.it/42x42">'+
                            '<div class="media-body">'+
                            'Item 0'+
                            '<p>Lorem ipsum dolor sit amet, consectetur adipisicing elit, sed do eiusmod tempor incididunt ut labore et dolore. Lorem ipsum dolor sit amet.</p>'+
                            '</div>'+
                            '</a>';
                    ul.insertBefore(li, ul.childNodes[0]);
                    myScroll.refresh();
//                    layer.close(index);
                    pullDown.innerHTML = "刷新成功";
                    setTimeout(function(){
                        pullDown.style.position = 'absolute';
                        pullDown.innerHTML = "下拉刷新...";
                    }, 1000);

                },2000);
            }
            function pullUpAction(){

                var index = layer.open({
                    type: 2,
                    shadow: false
                });
                setTimeout(function(){
                    var ul = document.querySelector('ul.table-view');
                    var li = document.createElement('li');
                    li.setAttribute("class","table-view-cell media");
                    li.innerHTML='<a class="navigate-right">'+
                            '<img class="media-object pull-left" src="http://placehold.it/42x42">'+
                            '<div class="media-body">'+
                            'Item 5'+
                            '<p>Lorem ipsum dolor sit amet, consectetur adipisicing elit, sed do eiusmod tempor incididunt ut labore et dolore. Lorem ipsum dolor sit amet.</p>'+
                            '</div>'+
                            '</a>';
                    ul.appendChild(li);
                    ul.appendChild(li);
                    console.log(li);
                    myScroll.refresh();
                    layer.close(index);
                },1000);
            }


            // vueJs
            var vm = new Vue({
                el: "#list",
                data: {
                    item: "标题",
                    content: "这是内容"
                },
                created: function() {
                    console.log('title is:'+this.item);
                }
            });

        }
        // 恢复版本

    </script>
</body>
</html>